<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sona Enterprises - Women's Fashion, Electronics & Toys</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Alpine.js for interactivity -->
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@600;700;800&display=swap" rel="stylesheet">
  <!-- Font Awesome for Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'sans-serif'],
            serif: ['Playfair Display', 'serif'],
          },
          colors: {
            amber: {
              50: '#fffbeb',
              100: '#fef3c7',
              200: '#fde68a',
              300: '#fcd34d',
              400: '#fbbf24',
              500: '#f59e0b',
              600: '#d97706',
              700: '#b45309',
              800: '#92400e',
              900: '#78350f',
            }
          }
        }
      }
    }
  </script>
  <style>
    /* Hide scrollbar for Chrome, Safari and Opera */
    .scrollbar-hide::-webkit-scrollbar {
        display: none;
    }
    /* Hide scrollbar for IE, Edge and Firefox */
    .scrollbar-hide {
        -ms-overflow-style: none;  /* IE and Edge */
        scrollbar-width: none;  /* Firefox */
    }
  </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/"
  }
}
</script>
  <!-- Custom styles -->
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@300;400;500;600;700&display=swap');

    body {
      font-family: 'Inter', sans-serif;
    }

    h1, h2, h3 {
      font-family: 'Playfair Display', serif;
    }
    .product-card {
    border: 1px solid rgba(0,0,0,0.12); /* thin soft black border */
    border-radius: 12px;               /* optional: keep rounded */
}

    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }

    .category-card:hover {
      transform: translateY(-5px);
    }

    .testimonial-card:hover {
      transform: translateY(-5px);
    }

    .product-card, .category-card, .testimonial-card {
      transition: all 0.3s ease;
    }

    /* Fade in animation for hero elements */
    .fade-in {
      animation: fadeIn 0.5s ease forwards;
      opacity: 0;
    }

    .fade-in-delay-1 {
      animation-delay: 0.2s;
    }

    .fade-in-delay-2 {
      animation-delay: 0.4s;
    }

    .fade-in-delay-3 {
      animation-delay: 0.6s;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Hero banner with overlay */
    .hero-banner {
      background-image: linear-gradient(135deg, rgba(28, 28, 28, 0.596) 0%, rgba(0, 0, 0, 0.559) 100%), url('https://res.cloudinary.com/dkfaom3zg/image/upload/v1763048645/bgimg_q4ynbd.png');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }

    @media (max-width: 768px) {
      .hero-banner {
        background-attachment: scroll;
      }
    }
  </style>
</head>
<body class="min-h-screen bg-grey-30 overflow-x-hidden ">
{% load custom_filters %}


  <!-- Header -->
  {% include 'nav.html' %}
  <!-- Main Content --><section class="hero-banner relative h-96 sm:h-[500px] md:h-[600px] flex items-center justify-center overflow-hidden" id="hero">
      <!-- Updated hero banner with proper centering and responsive design -->
      <div class="absolute inset-0 flex items-center justify-center">
        <div class="text-center px-4 sm:px-6 max-w-2xl animate-fade-in">
          {% if business_info %}
          <h1 class="text-3xl sm:text-4xl md:text-6xl font-bold text-white mb-2 sm:mb-4 leading-tight fade-in">
            Welcome to {{ business_info.business_name }}
          </h1>
          {% endif %}
          <p class="text-sm sm:text-base md:text-lg text-gray-100 mb-4 sm:mb-8 fade-in fade-in-delay-1">
            Your trusted partner in quality products
          </p>
          <div class="flex flex-col sm:flex-row gap-2 sm:gap-4 justify-center fade-in fade-in-delay-2">
            <a href="#women-products" class="bg-amber-600 hover:bg-amber-700 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-lg font-medium transition text-sm sm:text-base">
              Shop Now
            </a>
            <a href="/contact" class="border border-white text-white hover:bg-white/10 px-4 sm:px-6 py-2 sm:py-3 rounded-lg font-medium transition text-sm sm:text-base">
              Contact Us
            </a>
          </div>
        </div>
      </div>
    </section>

    


  <main id="catalog" class="container mx-auto px-4 py-16 md:py-24">

    <!-- Header -->
    <div class="text-center max-w-3xl mx-auto mb-12">
        <span class="text-amber-600 font-semibold tracking-wider text-sm uppercase mb-2 block">Our Collections</span>
        <h2 class="text-3xl md:text-5xl font-serif font-bold text-gray-900">Featured Products</h2>
    </div>

    <!-- ADVANCED LIVE SEARCH BAR -->
<div class="max-w-3xl mx-auto mb-10">
    <input 
        id="liveSearchInput"
        type="text" 
        placeholder="Search products (e.g., saree, handbag, heater, toys)..."
        class="w-full px-5 py-3 rounded-xl border border-gray-300 shadow-sm text-gray-800
               focus:ring-2 focus:ring-amber-500 focus:border-amber-500 outline-none text-lg"
        oninput="liveSearch()"
    >
</div>

<!-- No Results Message -->
<div id="noResults" class="hidden text-center text-gray-500 text-xl py-10">
    No matching products found.
</div>


    <!-- GLOBAL CATEGORY BUTTON BAR -->
    <div class="flex flex-wrap justify-center gap-3 mb-16 sticky top-4 z-40 bg-gray-50/95 backdrop-blur-sm py-4 -mx-4 px-4 md:static md:bg-transparent">
        <a href="#all" 
           class="px-6 py-2.5 rounded-full text-sm font-medium transition-all duration-300 border bg-amber-600 text-white border-amber-600 shadow-md">
            All
        </a>
        {% for cat in categories %}
        <a href="#category-{{ cat.slug }}"
           class="px-6 py-2.5 rounded-full text-sm font-medium transition-all duration-300 border bg-white text-gray-600 border-gray-200 hover:border-amber-500 hover:text-amber-600">
            {{ cat.name }}
        </a>
        {% endfor %}
    </div>

    {% if request.GET.category %}
    <div class="text-center mb-10">
        <a href="/"
          class="inline-block bg-gray-800 text-white px-6 py-2 rounded-full shadow hover:bg-black transition">
          ← Back to All Products
        </a>
    </div>
    {% endif %}

    <div id="allCategoriesWrapper">

      {% for category in categories %}
      <section id="category-{{ category.slug }}" class="mb-20 scroll-mt-28">

          <!-- Category Header -->
          <!-- Category Header -->
          <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-8 px-2">

      <!-- LEFT: Category Title -->
      <div class="flex-1">
          <h2 class="text-2xl md:text-3xl font-serif font-bold text-gray-900 capitalize">
              {{ category.name }}
          </h2>
          <div class="h-1 w-16 bg-amber-500 mt-2 rounded-full"></div>
      </div>

      <!-- CENTER: Subcategories (Centered Block) -->
          
  <!-- CENTER: Subcategories (Centered Block) -->
      <div class="flex-1 flex justify-center mt-4 md:mt-0">

          {% if category.children.exists %}
          <div class="flex flex-wrap justify-center gap-3">

              <!-- ALL Button (always orange by default) -->
              <a href="#category-{{ category.slug }}"
                class="
                    px-5 py-2 text-sm font-semibold rounded-lg border-2 shadow-sm transition-all duration-200
                    bg-amber-600 border-amber-600 text-white
                    hover:bg-amber-700 hover:border-amber-700
                ">
                  All
              </a>

              <!-- CHILD CATEGORY BUTTONS -->
              {% for sub in category.children.all %}
              <a href="/?category={{ sub.slug }}"
                  data-subcat="{{ sub.slug }}"
                  data-parent="{{ category.slug }}"


                class="
                    px-5 py-2 text-sm font-semibold rounded-lg border-2 shadow-sm transition-all duration-200

                    {% if request.GET.category == sub.slug %}
                        bg-amber-600 border-amber-600 text-white
                    {% else %}
                        bg-white border-gray-300 text-gray-700
                    {% endif %}


                    hover:bg-amber-600 hover:text-white hover:border-amber-600
                ">
                  {{ sub.name }}
              </a>
              {% endfor %}

          </div>
          {% endif %}
      </div>



      <!-- RIGHT: View Collection + Arrows -->
      <div class="flex-1 flex justify-end items-center gap-4 mt-4 md:mt-0">

          <a href="#category-{{ sub.slug }}"

              class="hidden md:inline-block text-sm font-medium text-amber-600 hover:text-amber-700 transition-colors">
              View Collection →
          </a>

          <div class="flex gap-2">
              <button onclick="scrollCat('{{ category.slug }}', -1)" 
                  class="h-9 w-9 rounded-full border border-gray-200 bg-white flex items-center justify-center text-gray-600 hover:border-amber-500 hover:text-amber-500 transition-all shadow-sm">
                  <i class="fas fa-chevron-left text-xs"></i>
              </button>

              <button onclick="scrollCat('{{ category.slug }}', 1)"
                  class="h-9 w-9 rounded-full border border-gray-200 bg-white flex items-center justify-center text-gray-600 hover:border-amber-500 hover:text-amber-500 transition-all shadow-sm">
                  <i class="fas fa-chevron-right text-xs"></i>
              </button>
          </div>

      </div>

          </div>



          {% with products=products_by_category|get_item:category.slug %}
          {% if products and products|length > 0 %}

          <div class="relative group/section">
              
              <!-- Scroll Container -->
              <div id="cat-{{ category.slug }}"
                  class="flex gap-6 overflow-x-auto scrollbar-hide snap-x snap-mandatory px-4 py-4 ">

                  {% for product in products %}
                  <!-- Product Card Wrapper -->
                  <div class="product-card-wrapper min-w-[250px] max-w-[260px] flex-shrink-0 snap-start h-full"
                      data-name="{{ product.name }}"
                      data-category="{{ product.category }}">



                      
                      <!-- Modern Product Card -->
                      <div class="group relative bg-white rounded-xl border border-black/20 shadow-sm transition-all duration-300 hover:shadow-xl hover:-translate-y-1 h-full flex flex-col overflow-hidden">

                          
                          <!-- Image Area -->
                          <div class="relative aspect-[4/5] overflow-hidden bg-gray-100">
                              <a href="{% url 'product_detail' product.pk product.slug %}" class="block h-full w-full">
                                  {% if product.get_primary_image_url %}

                                      <img src="{{ product.get_primary_image_url }}" alt="{{ product.name }}" loading="lazy" 
                                          class="h-full w-full object-cover transition-transform duration-700 ease-out group-hover:scale-110">
                                  {% else %}
                                      <div class="flex items-center justify-center h-full text-gray-400 bg-gray-50">
                                          <i class="fas fa-image text-3xl opacity-50"></i>
                                      </div>
                                  {% endif %}
                              </a>

                              <!-- Badges -->
                              <div class="absolute top-3 left-3 flex flex-col gap-2 pointer-events-none">
                                  {% if product.old_price %}
                                  <span class="bg-red-500 text-white text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded-sm shadow-sm">
                                      Sale
                                  </span>
                                  {% endif %}
                                  <!-- Example: Add logic for 'New' if available in backend -->
                                  <!-- {% if product.is_new %} <span class="bg-blue-600 ...">New</span> {% endif %} -->
                              </div>

                              <!-- Floating Actions (Wishlist/QuickView) -->
                              <div class="absolute top-3 right-3 flex flex-col gap-2
                                    transition-opacity duration-300 
                                    lg:opacity-0 lg:translate-x-2 
                                    lg:group-hover:opacity-100 lg:group-hover:translate-x-0">

                                  <a href="{% url 'add_to_wishlist' product.pk %}" class="h-9 w-9 bg-white rounded-full shadow-md flex items-center justify-center text-gray-400 hover:text-red-500 hover:bg-red-50 transition-colors" title="Add to Wishlist">
                                      <i class="fas fa-heart"></i>
                                  </a>
                                  <a href="{% url 'product_detail' product.pk product.slug %}" 
                                    class="h-9 w-9 bg-white rounded-full shadow-md flex items-center justify-center text-gray-400 hover:text-gray-900 hover:bg-gray-50 transition-colors" title="Quick View">
                                      <i class="fas fa-eye"></i>
                                  </a>
                              </div>

                              <!-- Desktop Quick Add Overlay -->
                              <div class="absolute bottom-0 left-0 right-0 p-4 translate-y-full transition-transform duration-300 group-hover:translate-y-0 bg-gradient-to-t from-black/60 to-transparent hidden lg:block">
                                  {% if product.available_stock|default:0 > 0 %}
                                      {% if user.is_authenticated %}
                                          {% if product.has_variants %}
                                          <a href="{% url 'product_detail' product.pk product.slug %}" 
                                            class="block w-full py-2.5 rounded-lg text-sm font-semibold shadow-lg transition-colors bg-amber-600 text-white hover:bg-amber-700 text-center">
                                              Select Options
                                          </a>
                                          {% else %}
                                          <a href="{% url 'add_to_cart' product.pk %}" 
                                            class="block w-full py-2.5 rounded-lg text-sm font-semibold shadow-lg transition-colors bg-amber-600 text-white hover:bg-amber-700 text-center">
                                              Add to Cart
                                          </a>
                                          {% endif %}
                                      {% else %}
                                          <a href="/" 
                                            class="block w-full py-2.5 rounded-lg text-sm font-semibold shadow-lg transition-colors bg-gray-800 text-white hover:bg-gray-900 text-center">
                                              Login to Buy
                                          </a>
                                      {% endif %}
                                  {% else %}
                                      <button disabled class="w-full py-2.5 rounded-lg text-sm font-semibold shadow-lg transition-colors bg-gray-400 text-gray-200 cursor-not-allowed">
                                          Out of Stock
                                      </button>
                                  {% endif %}
                              </div>
                          </div>

                          <!-- Card Content -->
                          <div class="p-4 flex flex-col flex-grow">
                              <div class="text-xs text-gray-500 mb-1">{{ product.category }}</div>
                              
                              <h3 class="font-medium text-gray-900 text-base leading-snug mb-2 line-clamp-2 min-h-[2.5em] group-hover:text-amber-700 transition-colors">
                                  <a href="{% url 'product_detail' product.pk product.slug %}">{{ product.name }}</a>
                              </h3>

                              <!-- Rating -->
                              <div class="flex items-center gap-1 mb-2">
      
                                <div class="text-amber-400 text-xs">
                                    <i class="fas fa-star"></i>
                                </div>

                                <!-- Average Rating -->
                                <span class="text-sm font-medium text-gray-700">
                                    {{ product.average_rating|floatformat:1 }}
                                </span>

                                <!-- Review Count Linked -->
                                {% if product.id %}
                                    <a href="{% url 'product_reviews' product.id %}"
                                      class="text-xs text-gray-500 hover:text-blue-600 hover:underline">
                                        ({{ product.review_count }})
                                    </a>
                                {% else %}
                                    <span class="text-xs text-gray-400">(0)</span>
                                {% endif %}

                              </div>



                              <!-- Price & Mobile Action -->
                              <div class="mt-auto pt-2 flex items-center justify-between border-t border-gray-50">
                                  <div class="flex flex-col">
                                      {% if product.old_price %}
                                      <span class="text-xs text-gray-400 line-through">₹{{ product.old_price }}</span>
                                      {% endif %}
                                      <span class="text-lg font-bold text-gray-900">₹{{ product.price }}</span>

                                      {% if product.available_stock > 0 %}
                                          <span class="text-xs text-green-600 font-medium">In Stock: {{ product.available_stock }}</span>
                                      {% else %}
                                          <span class="text-xs text-red-600 font-medium">Out of Stock</span>
                                      {% endif %}
                                  </div>


                                  <!-- Mobile Cart Icon (Visible only on small screens) -->
                                  <!-- Mobile Action (Visible only on small screens) -->
                                  <div class="lg:hidden">
                                      {% if product.available_stock|default:0 > 0 %}
                                          
                                          {% if user.is_authenticated %}
                                              <!-- Authenticated user → show ICON -->
                                              <a href="{% if product.has_variants %}
                                                          {% url 'product_detail' product.pk product.slug %}
                                                      {% else %}
                                                          {% url 'add_to_cart' product.pk %}
                                                      {% endif %}" 
                                                class="h-8 w-8 rounded-full flex items-center justify-center
                                                        transition-colors bg-amber-100 text-amber-700 hover:bg-amber-200">
                                                  <i class="fas fa-shopping-bag text-xs"></i>
                                              </a>

                                          {% else %}
                                              <!-- NOT LOGGED IN → Show TEXT instead -->
                                              <a href="/"
                                                class="text-red-600 text-xs font-semibold underline">
                                                Login to Buy
                                              </a>
                                          {% endif %}

                                      {% else %}
                                          <span class="text-red-600 text-xs font-semibold">Out of Stock</span>
                                      {% endif %}
                                  </div>

                              </div>
                          </div>
                      </div>
                      <!-- End Product Card -->

                  </div>
                  {% endfor %}

                  <!-- "See All" Card at end of scroll -->
                  

              </div>
          </div>

          {% else %}
          {% if not request.GET.category %}
          <div class="text-center py-10 bg-white rounded-xl border border-dashed border-gray-200">
              <p class="text-gray-400">No products available in this category.</p>
          </div>
          {% endif %}
          {% endif %}
        {% endwith %}
      </section>
      {% endfor %}
    </div>

    <!-- SEARCH RESULTS GRID -->
    <!-- SEARCH RESULTS (Horizontal Scroll like categories) -->
    <div id="searchResultsContainer" class="hidden mb-20">

        <h2 class="text-2xl md:text-3xl font-serif font-bold text-gray-900 mb-6">
            Search Results
        </h2>

        <!-- Scroll Controls (Desktop only) -->
        <div class="flex justify-end gap-2 mb-3 hidden md:flex">
            <button onclick="scrollSearch(-1)"
                class="h-9 w-9 rounded-full border border-gray-300 bg-white flex items-center justify-center 
                      text-gray-600 hover:border-amber-500 hover:text-amber-500 transition-all shadow-sm">
                <i class="fas fa-chevron-left text-xs"></i>
            </button>

            <button onclick="scrollSearch(1)"
                class="h-9 w-9 rounded-full border border-gray-300 bg-white flex items-center justify-center 
                      text-gray-600 hover:border-amber-500 hover:text-amber-500 transition-all shadow-sm">
                <i class="fas fa-chevron-right text-xs"></i>
            </button>
        </div>

        <!-- Scrollable Product Row -->
        <div id="searchResults"
            class="flex gap-6 overflow-x-auto scrollbar-hide snap-x snap-mandatory px-1 py-3">
            <!-- JS injects product cards here -->
        </div>

        <!-- No Results -->
        <div id="noResults" class="hidden text-center text-gray-500 text-xl py-10">
            No matching products found.
        </div>

    </div>



  </main>

  <script>
    function scrollCat(slug, dir) {
        const el = document.getElementById('cat-' + slug);
        if (!el) return;
        // Scroll amount: slightly less than full width to show preview of next item
        const amount = window.innerWidth > 768 ? 600 : 280;
        el.scrollBy({ left: dir * amount, behavior: 'smooth' });
    }
  </script>


  <!-- Footer -->
  {% include 'footer.html' %}

  <!-- Scripts -->
  <script>
    document.getElementById('current-year').textContent = new Date().getFullYear();

    // Profile Menu Toggle
    document.getElementById('profile-button')?.addEventListener('click', function () {
      document.getElementById('profile-menu')?.classList.toggle('hidden');
    });

    // Signup Button Toggle
    document.getElementById('signup-button')?.addEventListener('click', function () {
      const menu = document.getElementById('signup-menu');
      if (menu) menu.classList.toggle('hidden');
    });

    // Close menus when clicking outside
    document.addEventListener('click', function (e) {
      if (!e.target.closest('#profile-button') && !e.target.closest('#profile-menu')) {
        document.getElementById('profile-menu')?.classList.add('hidden');
      }
      if (!e.target.closest('#signup-button') && !e.target.closest('#signup-menu')) {
        document.getElementById('signup-menu')?.classList.add('hidden');
      }
    });
  </script>

  {% if messages %}
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
    {% for message in messages %}
      Swal.fire({
        toast: true,
        icon: "{{ message.tags }}",
        title: "{{ message }}",
        position: 'top',
        showConfirmButton: false,
        timer: 2000,
        timerProgressBar: true,
      });
    {% endfor %}
  </script>
  {% endif %}


  <script>
// Auto-scroll to the correct parent category section
document.addEventListener("DOMContentLoaded", function () {
    const urlParams = new URLSearchParams(window.location.search);
    const selected = urlParams.get("category");

    if (selected) {
        // Find the parent section that contains that subcategory
        const btn = document.querySelector(`[data-subcat="${selected}"]`);
        if (btn) {
            const parentSlug = btn.getAttribute("data-parent");
            const section = document.getElementById(`category-${parentSlug}`);
            if (section) {
                section.scrollIntoView({ behavior: "smooth", block: "start" });
            }
        }
    }
});
</script>


<script>
function liveSearch() {
    const query = document.getElementById("liveSearchInput").value.toLowerCase().trim();

    const allSections = document.getElementById("allCategoriesWrapper");
    const resultsContainer = document.getElementById("searchResultsContainer");
    const resultsRow = document.getElementById("searchResults");
    const noResults = document.getElementById("noResults");

    // RESET IF EMPTY
    if (query.length === 0) {
        allSections.classList.remove("hidden");
        resultsContainer.classList.add("hidden");
        noResults.classList.add("hidden");
        resultsRow.innerHTML = "";
        return;
    }

    // Hide categories + show search results
    allSections.classList.add("hidden");
    resultsContainer.classList.remove("hidden");

    resultsRow.innerHTML = ""; // clear previous items

    const products = document.querySelectorAll(".product-card-wrapper");

    let found = 0;

    products.forEach(card => {
        const name = card.dataset.name.toLowerCase();
        const category = card.dataset.category.toLowerCase();

        if (name.includes(query) || category.includes(query)) {
            found++;

            let clone = card.cloneNode(true);
            clone.classList.add("snap-start", "min-w-[250px]");
            resultsRow.appendChild(clone);
        }
    });

    if (found === 0) {
        noResults.classList.remove("hidden");
    } else {
        noResults.classList.add("hidden");
    }
}
</script>


<script>
function scrollSearch(dir) {
    const el = document.getElementById("searchResults");
    const amount = window.innerWidth > 768 ? 600 : 280;
    el.scrollBy({ left: dir * amount, behavior: "smooth" });
}
</script>




</body>
</html>
