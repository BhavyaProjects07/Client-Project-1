<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NewWay Online - Women's Fashion, Electronics & Toys</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Alpine.js for interactivity -->
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@600;700;800&display=swap" rel="stylesheet">
  <!-- Font Awesome for Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'sans-serif'],
            serif: ['Playfair Display', 'serif'],
          },
          colors: {
            amber: {
              50: '#fffbeb',
              100: '#fef3c7',
              200: '#fde68a',
              300: '#fcd34d',
              400: '#fbbf24',
              500: '#f59e0b',
              600: '#d97706',
              700: '#b45309',
              800: '#92400e',
              900: '#78350f',
            }
          },
          keyframes: {
            'float': {
              '0%, 100%': { transform: 'translateY(0px)' },
              '50%': { transform: 'translateY(-20px)' },
            },
            'slide-up': {
              'from': { opacity: '0', transform: 'translateY(40px)' },
              'to': { opacity: '1', transform: 'translateY(0)' },
            },
            'scale-in': {
              'from': { opacity: '0', transform: 'scale(0.95)' },
              'to': { opacity: '1', transform: 'scale(1)' },
            },
          },
          animation: {
            'float': 'float 6s ease-in-out infinite',
            'slide-up': 'slide-up 0.6s ease-out',
            'scale-in': 'scale-in 0.4s ease-out',
          },
        }
      }
    }
  </script>
  <style>
    /* Hide scrollbar for Chrome, Safari and Opera */
    .scrollbar-hide::-webkit-scrollbar {
        display: none;
    }
    /* Hide scrollbar for IE, Edge and Firefox */
    .scrollbar-hide {
        -ms-overflow-style: none;  /* IE and Edge */
        scrollbar-width: none;  /* Firefox */
    }
  </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/"
  }
}
</script>
  <!-- Custom styles -->
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@300;400;500;600;700&display=swap');

    * {
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: #f9fafb;
    }

    h1, h2, h3 {
      font-family: 'Playfair Display', serif;
      letter-spacing: -0.5px;
    }

    /* Premium Product Card with Advanced Hover */
    .product-card {
      border: 1px solid rgba(0, 0, 0, 0.08);
      border-radius: 16px;
      background: linear-gradient(135deg, rgba(255,255,255,1) 0%, rgba(255,255,255,0.98) 100%);
      transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
      position: relative;
      overflow: hidden;
    }

    .product-card:hover {
      transform: translateY(-12px) scale(1.01);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.12), 0 0 0 1px rgba(217, 119, 6, 0.1);
      border-color: rgba(217, 119, 6, 0.2);
    }

    .category-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
    }

    .testimonial-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
    }

    .product-card, .category-card, .testimonial-card {
      transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
    }

    /* Premium Fade In Animation */
    .fade-in {
      animation: fadeInPremium 0.7s cubic-bezier(0.23, 1, 0.32, 1) forwards;
      opacity: 0;
    }

    .fade-in-delay-1 {
      animation-delay: 0.15s;
    }

    .fade-in-delay-2 {
      animation-delay: 0.3s;
    }

    .fade-in-delay-3 {
      animation-delay: 0.45s;
    }

    @keyframes fadeInPremium {
      from {
        opacity: 0;
        transform: translateY(30px);
        filter: blur(8px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
        filter: blur(0);
      }
    }

    /* Hero Banner with Dynamic Overlay */
    .hero-banner {
      background-image: linear-gradient(135deg, rgba(28, 28, 28, 0.6) 0%, rgba(0, 0, 0, 0.55) 100%), url('https://res.cloudinary.com/dkfaom3zg/image/upload/v1763048645/bgimg_q4ynbd.png');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      position: relative;
      overflow: hidden;
    }

    .hero-banner::before {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 30% 50%, rgba(217, 119, 6, 0.15) 0%, transparent 50%);
      animation: pulse 8s ease-in-out infinite;
      pointer-events: none;
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 0.6; }
    }

    /* Search Bar Premium Styling */
    #liveSearchInput {
      background: linear-gradient(135deg, #ffffff 0%, #fafafa 100%);
      border: 2px solid transparent;
      transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    }

    #liveSearchInput:focus {
      border-color: #d97706;
      box-shadow: 0 0 0 3px rgba(217, 119, 6, 0.1), 0 10px 20px rgba(0, 0, 0, 0.1);
      background: #ffffff;
      transform: translateY(-2px);
    }

    /* Button Interactive Effects */
    .btn-interactive {
      position: relative;
      overflow: hidden;
      transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
    }

    .btn-interactive:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
    }

    /* Product Image Zoom Effect */
    .product-card img {
      transition: transform 0.8s cubic-bezier(0.23, 1, 0.32, 1), filter 0.8s ease;
    }

    .product-card:hover img {
      transform: scale(1.12) rotate(1deg);
      filter: brightness(1.08);
    }

    /* Category Button Transitions */
    .category-btn {
      transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
      position: relative;
      overflow: hidden;
    }

    .category-btn:hover {
      transform: translateY(-2px);
    }

    /* Badge Bounce Animation */
    .badge-animation {
      animation: badgeBounce 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    @keyframes badgeBounce {
      0% { transform: scale(0) rotate(-45deg); opacity: 0; }
      50% { transform: scale(1.1); }
      100% { transform: scale(1) rotate(0); opacity: 1; }
    }

    /* Stagger Animation */
    .stagger-item {
      animation: slideUp 0.6s cubic-bezier(0.23, 1, 0.32, 1) forwards;
      opacity: 0;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(40px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @media (max-width: 768px) {
      .hero-banner {
        background-attachment: scroll;
      }
    }
  </style>
</head>

<body class="min-h-screen bg-gray-50 overflow-x-hidden">
<script>
// Enhanced Intersection Observer for animations
const observerOptions = {
  threshold: 0.1,
  rootMargin: '0px 0px -100px 0px'
};

const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.style.animation = 'slideUp 0.6s cubic-bezier(0.23, 1, 0.32, 1) forwards';
      observer.unobserve(entry.target);
    }
  });
}, observerOptions);

// Observe all stagger items
document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('.stagger-item').forEach(el => {
    observer.observe(el);
  });

  // Smooth scroll for category links
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function(e) {
      const href = this.getAttribute('href');
      if (href !== '#' && document.querySelector(href)) {
        e.preventDefault();
        const target = document.querySelector(href);
        setTimeout(() => {
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 100);
      }
    });
  });

  // Product card hover ripple effect
  document.querySelectorAll('.product-card').forEach(card => {
    card.addEventListener('mouseenter', function() {
      this.style.willChange = 'transform, box-shadow';
    });
    card.addEventListener('mouseleave', function() {
      this.style.willChange = 'auto';
    });
  });

  // Search input auto-focus animation
  const searchInput = document.getElementById('liveSearchInput');
  if (searchInput) {
    searchInput.addEventListener('focus', function() {
      this.style.transform = 'translateY(-2px)';
    });
    searchInput.addEventListener('blur', function() {
      this.style.transform = 'translateY(0)';
    });
  }
});

// Smooth scroll behavior for the entire page
window.addEventListener('scroll', () => {
  const hero = document.getElementById('hero');
  const scrollPosition = window.scrollY;
  
  if (hero) {
    hero.style.backgroundPosition = `center ${scrollPosition * 0.5}px`;
  }
});
</script>
{% load custom_filters %}


  <!-- Header -->
  {% include 'nav.html' %}
  
  <!-- Premium Hero Section -->
   {% include 'hero.html' %}
    


   {% include 'latest_products.html' %}
  <main id="catalog" class="container mx-auto px-4 py-20 md:py-32">


    <!-- Premium Section Header -->
    <div class="text-center max-w-4xl mx-auto mb-16">
      <div class="mb-4 inline-block">
        <span class="inline-block px-4 py-2 rounded-full bg-amber-100 text-amber-700 text-xs sm:text-sm font-semibold tracking-widest uppercase">Featured Collections</span>
      </div>
      <h2 class="text-3xl sm:text-4xl md:text-6xl font-serif font-bold text-gray-900 mb-4 leading-tight">
        Explore Our <span class="bg-gradient-to-r from-amber-600 to-amber-500 bg-clip-text text-transparent">Curated Selection</span>
      </h2>
      <p class="text-gray-600 text-sm sm:text-base md:text-lg leading-relaxed max-w-2xl mx-auto">
        Handpicked products designed to elevate your lifestyle with quality, style, and innovation.
      </p>
    </div>

    <!-- Premium Live Search Bar -->
    <div class="max-w-2xl mx-auto mb-12 stagger-item">
      <div class="relative group">
        <input 
            id="liveSearchInput"
            type="text" 
            placeholder="Search products (saree, handbag, heater, toys...)..."
            class="w-full px-6 py-4 rounded-xl border-2 border-gray-200 shadow-lg text-gray-800
                   focus:ring-2 focus:ring-amber-500 focus:border-amber-500 outline-none text-base sm:text-lg
                   placeholder-gray-400 transition-all duration-300 group-hover:border-amber-300"
            oninput="liveSearch()"
        >
        <i class="fas fa-search absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 text-lg pointer-events-none group-hover:text-amber-500 transition-colors duration-300"></i>
      </div>
    </div>

    <!-- No Results Message -->
    <div id="noResults" class="hidden text-center text-gray-500 text-lg py-16 animate-fade-in">
      <i class="fas fa-search text-5xl mb-4 opacity-30"></i>
      <p>No matching products found. Try adjusting your search.</p>
    </div>

    <!-- Premium Category Filter Bar -->
    <div class="flex flex-wrap justify-center gap-2 sm:gap-3 mb-16 sticky top-20 z-40 bg-gradient-to-b from-white/95 to-white/80 backdrop-blur-md py-6 -mx-4 px-4 md:static md:bg-transparent rounded-b-2xl transition-all duration-300 stagger-item">
        <a href="#all" 
           class="category-btn px-5 sm:px-6 py-2.5 sm:py-3 rounded-full text-xs sm:text-sm font-semibold transition-all duration-300 border-2 bg-gradient-to-r from-amber-600 to-amber-700 text-white border-amber-600 shadow-lg hover:shadow-amber-600/40">
            All Products
        </a>
        {% for cat in categories %}
        <a href="#category-{{ cat.slug }}"
           class="category-btn px-5 sm:px-6 py-2.5 sm:py-3 rounded-full text-xs sm:text-sm font-semibold transition-all duration-300 border-2 bg-white text-gray-700 border-gray-200 hover:border-amber-500 hover:text-amber-600 hover:bg-amber-50 shadow-sm">
            {{ cat.name }}
        </a>
        {% endfor %}
    </div>

    {% if request.GET.category %}
    <div class="text-center mb-12 animate-slide-up">
        <a href="/"
          class="inline-flex items-center gap-2 bg-gray-900 hover:bg-black text-white px-6 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105">
          <i class="fas fa-arrow-left"></i>
          Back to All Products
        </a>
    </div>
    {% endif %}

    <div id="allCategoriesWrapper">

      {% for category in categories %}
      <section id="category-{{ category.slug }}" class="mb-24 scroll-mt-32 stagger-item">

          <!-- Premium Category Header with Animations -->
          <div class="flex flex-col md:flex-row md:items-end md:justify-between mb-10 px-2 gap-6">

            <!-- LEFT: Category Title with Animation -->
            <div class="flex-1">
                <h2 class="text-2xl sm:text-3xl md:text-4xl font-serif font-bold text-gray-900 capitalize mb-3 leading-tight">
                    {{ category.name }}
                </h2>
                <div class="h-1 w-20 bg-gradient-to-r from-amber-600 to-amber-500 rounded-full"></div>
            </div>

            <!-- CENTER: Subcategories (Centered Block) -->
            <div class="flex-1 flex justify-center md:justify-end">
                {% if category.children.exists %}
                <div class="flex flex-wrap justify-center gap-2 sm:gap-3">

                    <!-- ALL Button -->
                    <a href="#category-{{ category.slug }}"
                      class="category-btn px-4 sm:px-5 py-2 text-xs sm:text-sm font-semibold rounded-lg border-2 shadow-sm transition-all duration-300
                          bg-gradient-to-r from-amber-600 to-amber-700 border-amber-600 text-white
                          hover:shadow-lg hover:shadow-amber-600/30">
                        All
                    </a>

                    <!-- CHILD CATEGORY BUTTONS -->
                    {% for sub in category.children.all %}
                    <a href="/?category={{ sub.slug }}"
                        data-subcat="{{ sub.slug }}"
                        data-parent="{{ category.slug }}"
                        class="category-btn px-4 sm:px-5 py-2 text-xs sm:text-sm font-semibold rounded-lg border-2 shadow-sm transition-all duration-300
                            {% if request.GET.category == sub.slug %}
                                bg-gradient-to-r from-amber-600 to-amber-700 border-amber-600 text-white hover:shadow-lg hover:shadow-amber-600/30
                            {% else %}
                                bg-white border-gray-300 text-gray-700 hover:border-amber-500 hover:text-amber-600 hover:bg-amber-50
                            {% endif %}">
                        {{ sub.name }}
                    </a>
                    {% endfor %}

                </div>
                {% endif %}
            </div>



            <!-- RIGHT: Scroll Controls -->
            <div class="flex justify-center md:justify-end items-center gap-3">
                <button onclick="scrollCat('{{ category.slug }}', -1)" 
                    class="category-btn h-10 w-10 rounded-full border-2 border-gray-200 bg-white hover:border-amber-500 hover:bg-amber-50 flex items-center justify-center text-gray-600 hover:text-amber-600 shadow-sm hover:shadow-md">
                    <i class="fas fa-chevron-left text-sm"></i>
                </button>
                <button onclick="scrollCat('{{ category.slug }}', 1)"
                    class="category-btn h-10 w-10 rounded-full border-2 border-gray-200 bg-white hover:border-amber-500 hover:bg-amber-50 flex items-center justify-center text-gray-600 hover:text-amber-600 shadow-sm hover:shadow-md">
                    <i class="fas fa-chevron-right text-sm"></i>
                </button>
            </div>

          </div>



          {% with products=products_by_category|get_item:category.slug %}
          {% if products and products|length > 0 %}

          <div class="relative group/section">
              
              <!-- Scroll Container -->
              <div id="cat-{{ category.slug }}"
                  class="flex gap-6 overflow-x-auto scrollbar-hide snap-x snap-mandatory px-4 py-4 ">

                  {% for product in products %}
                  <!-- Product Card Wrapper -->
                  <div class="product-card-wrapper min-w-[250px] max-w-[260px] flex-shrink-0 snap-start h-full"
                      data-name="{{ product.name }}"
                      data-category="{{ product.category }}">



                      
                      <!-- Modern Product Card -->
                      <div class="group relative bg-white rounded-xl border border-black/20 shadow-sm transition-all duration-300 hover:shadow-xl hover:-translate-y-1 h-full flex flex-col overflow-hidden">

                          
                          <!-- Image Area -->
                          <div class="relative aspect-[4/5] overflow-hidden bg-gray-100">
                              <a href="{% url 'product_detail' product.pk product.slug %}" class="block h-full w-full">
                                  {% if product.get_primary_image_url %}

                                      <img src="{{ product.get_primary_image_url }}" alt="{{ product.name }}" loading="lazy" 
                                          class="h-full w-full object-cover transition-transform duration-700 ease-out group-hover:scale-110">
                                  {% else %}
                                      <div class="flex items-center justify-center h-full text-gray-400 bg-gray-50">
                                          <i class="fas fa-image text-3xl opacity-50"></i>
                                      </div>
                                  {% endif %}
                              </a>

                              <!-- Badges -->
                              <div class="absolute top-3 left-3 flex flex-col gap-2 pointer-events-none">
                                  {% if product.old_price %}
                                  <span class="bg-red-500 text-white text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded-sm shadow-sm">
                                      Sale
                                  </span>
                                  {% endif %}
                                  <!-- Example: Add logic for 'New' if available in backend -->
                                  <!-- {% if product.is_new %} <span class="bg-blue-600 ...">New</span> {% endif %} -->
                              </div>

                              <!-- Floating Actions (Wishlist/QuickView) -->
                              <div class="absolute top-3 right-3 flex flex-col gap-2
                                    transition-opacity duration-300 
                                    lg:opacity-0 lg:translate-x-2 
                                    lg:group-hover:opacity-100 lg:group-hover:translate-x-0">

                                  <a href="{% url 'add_to_wishlist' product.pk %}" class="h-9 w-9 bg-white rounded-full shadow-md flex items-center justify-center text-gray-400 hover:text-red-500 hover:bg-red-50 transition-colors" title="Add to Wishlist">
                                      <i class="fas fa-heart"></i>
                                  </a>
                                  <a href="{% url 'product_detail' product.pk product.slug %}" 
                                    class="h-9 w-9 bg-white rounded-full shadow-md flex items-center justify-center text-gray-400 hover:text-gray-900 hover:bg-gray-50 transition-colors" title="Quick View">
                                      <i class="fas fa-eye"></i>
                                  </a>
                              </div>

                              <!-- Desktop Quick Add Overlay -->
                              <div class="absolute bottom-0 left-0 right-0 p-4 translate-y-full transition-transform duration-300 group-hover:translate-y-0 bg-gradient-to-t from-black/60 to-transparent hidden lg:block">
                                  {% if product.available_stock|default:0 > 0 %}
                                      {% if user.is_authenticated %}
                                          {% if product.has_variants %}
                                          <a href="{% url 'product_detail' product.pk product.slug %}" 
                                            class="block w-full py-2.5 rounded-lg text-sm font-semibold shadow-lg transition-colors bg-amber-600 text-white hover:bg-amber-700 text-center">
                                              Select Options
                                          </a>
                                          {% else %}
                                          <a href="{% url 'add_to_cart' product.pk %}" 
                                            class="block w-full py-2.5 rounded-lg text-sm font-semibold shadow-lg transition-colors bg-amber-600 text-white hover:bg-amber-700 text-center">
                                              Add to Cart
                                          </a>
                                          {% endif %}
                                      {% else %}
                                          <a href="/" 
                                            class="block w-full py-2.5 rounded-lg text-sm font-semibold shadow-lg transition-colors bg-gray-800 text-white hover:bg-gray-900 text-center">
                                              Login to Buy
                                          </a>
                                      {% endif %}
                                  {% else %}
                                      <button disabled class="w-full py-2.5 rounded-lg text-sm font-semibold shadow-lg transition-colors bg-gray-400 text-gray-200 cursor-not-allowed">
                                          Out of Stock
                                      </button>
                                  {% endif %}
                              </div>
                          </div>

                          <!-- Card Content -->
                          <div class="p-4 flex flex-col flex-grow">
                              <div class="text-xs text-gray-500 mb-1">{{ product.category }}</div>
                              
                              <h3 class="font-medium text-gray-900 text-base leading-snug mb-2 line-clamp-2 min-h-[2.5em] group-hover:text-amber-700 transition-colors">
                                  <a href="{% url 'product_detail' product.pk product.slug %}">{{ product.name }}</a>
                              </h3>

                              <!-- Rating -->
                              <div class="flex items-center gap-1 mb-2">
      
                                <div class="text-amber-400 text-xs">
                                    <i class="fas fa-star"></i>
                                </div>

                                <!-- Average Rating -->
                                <span class="text-sm font-medium text-gray-700">
                                    {{ product.average_rating|floatformat:1 }}
                                </span>

                                <!-- Review Count Linked -->
                                {% if product.id %}
                                    <a href="{% url 'product_reviews' product.id %}"
                                      class="text-xs text-gray-500 hover:text-blue-600 hover:underline">
                                        ({{ product.review_count }})
                                    </a>
                                {% else %}
                                    <span class="text-xs text-gray-400">(0)</span>
                                {% endif %}

                              </div>



                              <!-- Price & Mobile Action -->
                              <div class="mt-auto pt-2 flex items-center justify-between border-t border-gray-50">
                                  <div class="flex flex-col">
                                      {% if product.old_price %}
                                      <span class="text-xs text-gray-400 line-through">₹{{ product.old_price }}</span>
                                      {% endif %}
                                      <span class="text-lg font-bold text-gray-900">₹{{ product.price }}</span>

                                      {% if product.available_stock > 0 %}
                                          <span class="text-xs text-green-600 font-medium">In Stock: {{ product.available_stock }}</span>
                                      {% else %}
                                          <span class="text-xs text-red-600 font-medium">Out of Stock</span>
                                      {% endif %}
                                  </div>


                                  <!-- Mobile Cart Icon (Visible only on small screens) -->
                                  <!-- Mobile Action (Visible only on small screens) -->
                                  <div class="lg:hidden">
                                      {% if product.available_stock|default:0 > 0 %}
                                          
                                          {% if user.is_authenticated %}
                                              <!-- Authenticated user → show ICON -->
                                              <a href="{% if product.has_variants %}
                                                          {% url 'product_detail' product.pk product.slug %}
                                                      {% else %}
                                                          {% url 'add_to_cart' product.pk %}
                                                      {% endif %}" 
                                                class="h-8 w-8 rounded-full flex items-center justify-center
                                                        transition-colors bg-amber-100 text-amber-700 hover:bg-amber-200">
                                                  <i class="fas fa-shopping-bag text-xs"></i>
                                              </a>

                                          {% else %}
                                              <!-- NOT LOGGED IN → Show TEXT instead -->
                                              <a href="/"
                                                class="text-red-600 text-xs font-semibold underline">
                                                Login to Buy
                                              </a>
                                          {% endif %}

                                      {% else %}
                                          <span class="text-red-600 text-xs font-semibold">Out of Stock</span>
                                      {% endif %}
                                  </div>

                              </div>
                          </div>
                      </div>
                      <!-- End Product Card -->

                  </div>
                  {% endfor %}

                  <!-- "See All" Card at end of scroll -->
                  

              </div>
          </div>

          {% else %}
          {% if not request.GET.category %}
          <div class="text-center py-10 bg-white rounded-xl border border-dashed border-gray-200">
              <p class="text-gray-400">No products available in this category.</p>
          </div>
          {% endif %}
          {% endif %}
        {% endwith %}
      </section>
      {% endfor %}
    </div>

    <!-- SEARCH RESULTS GRID -->
    <!-- SEARCH RESULTS (Horizontal Scroll like categories) -->
    <div id="searchResultsContainer" class="hidden mb-20">

        <h2 class="text-2xl md:text-3xl font-serif font-bold text-gray-900 mb-6">
            Search Results
        </h2>

        <!-- Scroll Controls (Desktop only) -->
        <div class="flex justify-end gap-2 mb-3 hidden md:flex">
            <button onclick="scrollSearch(-1)"
                class="h-9 w-9 rounded-full border border-gray-300 bg-white flex items-center justify-center 
                      text-gray-600 hover:border-amber-500 hover:text-amber-500 transition-all shadow-sm">
                <i class="fas fa-chevron-left text-xs"></i>
            </button>

            <button onclick="scrollSearch(1)"
                class="h-9 w-9 rounded-full border border-gray-300 bg-white flex items-center justify-center 
                      text-gray-600 hover:border-amber-500 hover:text-amber-500 transition-all shadow-sm">
                <i class="fas fa-chevron-right text-xs"></i>
            </button>
        </div>

        <!-- Scrollable Product Row -->
        <div id="searchResults"
            class="flex gap-6 overflow-x-auto scrollbar-hide snap-x snap-mandatory px-1 py-3">
            <!-- JS injects product cards here -->
        </div>

        <!-- No Results -->
        <div id="noResults" class="hidden text-center text-gray-500 text-xl py-10">
            No matching products found.
        </div>

    </div>



  </main>

  <script>
    function scrollCat(slug, dir) {
        const el = document.getElementById('cat-' + slug);
        if (!el) return;
        // Scroll amount: slightly less than full width to show preview of next item
        const amount = window.innerWidth > 768 ? 600 : 280;
        el.scrollBy({ left: dir * amount, behavior: 'smooth' });
    }
  </script>
 

  <!-- Footer -->
  {% include 'footer.html' %}

  <!-- Scripts -->
  <script>
    document.getElementById('current-year').textContent = new Date().getFullYear();

    // Profile Menu Toggle
    document.getElementById('profile-button')?.addEventListener('click', function () {
      document.getElementById('profile-menu')?.classList.toggle('hidden');
    });

    // Signup Button Toggle
    document.getElementById('signup-button')?.addEventListener('click', function () {
      const menu = document.getElementById('signup-menu');
      if (menu) menu.classList.toggle('hidden');
    });

    // Close menus when clicking outside
    document.addEventListener('click', function (e) {
      if (!e.target.closest('#profile-button') && !e.target.closest('#profile-menu')) {
        document.getElementById('profile-menu')?.classList.add('hidden');
      }
      if (!e.target.closest('#signup-button') && !e.target.closest('#signup-menu')) {
        document.getElementById('signup-menu')?.classList.add('hidden');
      }
    });
  </script>

  {% if messages %}
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
    {% for message in messages %}
      Swal.fire({
        toast: true,
        icon: "{{ message.tags }}",
        title: "{{ message }}",
        position: 'top',
        showConfirmButton: false,
        timer: 2000,
        timerProgressBar: true,
      });
    {% endfor %}
  </script>
  {% endif %}


  <script>
// Auto-scroll to the correct parent category section
document.addEventListener("DOMContentLoaded", function () {
    const urlParams = new URLSearchParams(window.location.search);
    const selected = urlParams.get("category");

    if (selected) {
        // Find the parent section that contains that subcategory
        const btn = document.querySelector(`[data-subcat="${selected}"]`);
        if (btn) {
            const parentSlug = btn.getAttribute("data-parent");
            const section = document.getElementById(`category-${parentSlug}`);
            if (section) {
                section.scrollIntoView({ behavior: "smooth", block: "start" });
            }
        }
    }
});
</script>


<script>
function liveSearch() {
    const query = document.getElementById("liveSearchInput").value.toLowerCase().trim();

    const allSections = document.getElementById("allCategoriesWrapper");
    const resultsContainer = document.getElementById("searchResultsContainer");
    const resultsRow = document.getElementById("searchResults");
    const noResults = document.getElementById("noResults");

    // RESET IF EMPTY
    if (query.length === 0) {
        allSections.classList.remove("hidden");
        resultsContainer.classList.add("hidden");
        noResults.classList.add("hidden");
        resultsRow.innerHTML = "";
        return;
    }

    // Hide categories + show search results
    allSections.classList.add("hidden");
    resultsContainer.classList.remove("hidden");

    resultsRow.innerHTML = ""; // clear previous items

    const products = document.querySelectorAll(".product-card-wrapper");

    let found = 0;

    products.forEach(card => {
        const name = card.dataset.name.toLowerCase();
        const category = card.dataset.category.toLowerCase();

        if (name.includes(query) || category.includes(query)) {
            found++;

            let clone = card.cloneNode(true);
            clone.classList.add("snap-start", "min-w-[250px]");
            resultsRow.appendChild(clone);
        }
    });

    if (found === 0) {
        noResults.classList.remove("hidden");
    } else {
        noResults.classList.add("hidden");
    }
}
</script>


<script>
function scrollSearch(dir) {
    const el = document.getElementById("searchResults");
    const amount = window.innerWidth > 768 ? 600 : 280;
    el.scrollBy({ left: dir * amount, behavior: "smooth" });
}
</script>




</body>
</html>
