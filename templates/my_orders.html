{% include 'nav.html' %}

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

<script>
  tailwind.config = {
    theme: {
      extend: {
        colors: {
          primary: {
            50: '#f0fdf4',
            100: '#dcfce7',
            200: '#bbf7d0',
            300: '#86efac',
            400: '#4ade80',
            500: '#22c55e',
            600: '#16a34a',
            700: '#15803d',
            800: '#166534',
            900: '#14532d',
          }
        },
        fontFamily: {
          sans: ['Inter', 'sans-serif'],
        }
      }
    }
  }
</script>

<style>
  body {
    font-family: 'Inter', sans-serif;
  }

  /* Modified grid layout - 2 columns on mobile, 3 on tablet, 4 on desktop, full width */
  .orders-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.5rem;
  }

  @media (min-width: 640px) {
    .orders-grid {
      grid-template-columns: repeat(3, 1fr);
      gap: 0.75rem;
    }
  }

  @media (min-width: 1024px) {
    .orders-grid {
      grid-template-columns: repeat(4, 1fr);
      gap: 1rem;
    }
  }

  .order-card {
    display: flex;
    flex-direction: column;
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 0.5rem;
    overflow: hidden;
    transition: all 0.3s ease;
    height: 100%;
  }

  .order-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
  }

  .card-image-container {
    width: 100%;
    height: 140px;
    background-color: #f3f4f6;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    position: relative;
    border-bottom: 1px solid #e5e7eb;
  }

  .product-image {
    width: 100%;
    height: 100%;
    object-fit: contain;
    transition: transform 0.3s ease;
    padding: 0.5rem;
  }

  .product-image:hover {
    transform: scale(1.05);
  }

  .quantity-badge {
    position: absolute;
    top: -6px;
    right: -6px;
    background: #22c55e;
    color: white;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.65rem;
    font-weight: 700;
    border: 2px solid white;
  }

  .card-content {
    padding: 0.75rem;
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  .card-title {
    font-size: 0.8rem;
    font-weight: 500;
    color: #111827;
    margin-bottom: 0.25rem;
    line-height: 1.2;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .card-price {
    font-size: 0.95rem;
    font-weight: 700;
    color: #111827;
    margin-bottom: 0.25rem;
  }

  .card-status {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.7rem;
    font-weight: 600;
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
    margin-bottom: 0.5rem;
    width: fit-content;
  }

  .status-delivered {
    background-color: #dcfce7;
    color: #166534;
  }

  .status-processing {
    background-color: #dbeafe;
    color: #1e40af;
  }

  .status-shipped {
    background-color: #fef3c7;
    color: #d97706;
  }

  .status-cancelled {
    background-color: #fee2e2;
    color: #dc2626;
  }

  .status-pending {
    background-color: #f3f4f6;
    color: #6b7280;
  }

  .card-delivery {
    font-size: 0.7rem;
    color: #6b7280;
    margin-bottom: 0.5rem;
  }

  .card-button {
    margin-top: auto;
    padding: 0.5rem 0.75rem;
    background-color: #22c55e;
    color: white;
    text-align: center;
    border: none;
    border-radius: 0.375rem;
    font-size: 0.7rem;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.2s;
    width: 100%;
  }

  .card-button:hover {
    background-color: #16a34a;
  }

  .card-button-secondary {
    background-color: white;
    border: 1px solid #d1d5db;
    color: #374151;
  }

  .card-button-secondary:hover {
    background-color: #f3f4f6;
  }
</style>

<!-- Changed container to full-width with no max-width constraint on mobile -->
<div class="bg-gray-50 min-h-screen">
  <div class="w-full px-2 sm:px-4 py-3 sm:py-8 lg:max-w-7xl lg:mx-auto">
    <!-- Page Header -->
    <div class="mb-3 sm:mb-6">
      <h1 class="text-xl sm:text-3xl font-semibold text-gray-800">My Orders</h1>
      <p class="text-gray-500 text-xs sm:text-base">Track and manage your orders</p>
    </div>

    {% if orders %}
    <!-- Grid container instead of vertical list -->
    <div class="orders-grid">
      {% for order in orders %}
        {% for item in order.items.all %}
          {% with product=item.get_product %}
          <div class="order-card">
            <!-- Product Image -->
            <div class="card-image-container">
              <img src="{{ product.image.url }}" alt="{{ product.name }}" class="product-image">
              {% if item.quantity > 1 %}
              <div class="quantity-badge">{{ item.quantity }}</div>
              {% endif %}
            </div>

            <!-- Card Content -->
            <div class="card-content">
              <h3 class="card-title">{{ product.name }}</h3>
              
              <div class="card-status status-{{ order.order_status|lower }}">
                <span class="w-1.5 h-1.5 rounded-full 
                  {% if order.order_status == 'Delivered' %}bg-green-600
                  {% elif order.order_status == 'Processing' %}bg-blue-600
                  {% elif order.order_status == 'Shipped' %}bg-yellow-600
                  {% elif order.order_status == 'Cancelled' %}bg-red-600
                  {% else %}bg-gray-600{% endif %}"></span>
                {{ order.order_status }}
              </div>

              <div class="card-price">‚Çπ{{ product.price }}</div>
              
              {% if order.order_status == 'Delivered' %}
              <div class="card-delivery">
                ‚úì Delivered
              </div>
              {% else %}
              <div class="card-delivery">
                {{ order.created_at|date:"M d, Y" }}
              </div>
              {% endif %}

              {% if order.order_status == 'Delivered' %}
              <a href="{% url 'submit_review' order.id item.product_type product.id %}" class="mt-auto">
                <button class="card-button">
                  <i class='bx bx-star' style="font-size: 0.8rem;"></i> Rate
                </button>
              </a>
              {% else %}
              <a href="{% url 'track_order' order.id %}" class="mt-auto">
                <button class="card-button">
                  <i class='bx bx-map-pin' style="font-size: 0.8rem;"></i> Track
                </button>
              </a>
              {% endif %}
            </div>
          </div>
          {% endwith %}
        {% endfor %}
      {% endfor %}
    </div>

    <!-- Load More -->
    <div class="mt-6 sm:mt-8 text-center">
      <button class="inline-flex justify-center items-center px-5 py-2 sm:px-6 sm:py-3 border border-gray-300 rounded-md text-xs sm:text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors">
        <i class='bx bx-refresh mr-2'></i> Load More Orders
      </button>
    </div>

    {% else %}
    <!-- Empty State - Mobile-optimized empty state -->
    <div class="bg-white rounded-lg border border-gray-200 p-6 sm:p-12 text-center">
      <div class="mx-auto w-16 h-16 sm:w-24 sm:h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4 sm:mb-6">
        <i class='bx bx-package text-2xl sm:text-4xl text-gray-400'></i>
      </div>

      <h3 class="text-base sm:text-xl font-semibold text-gray-900 mb-2">No orders yet</h3>
      <p class="text-gray-600 mb-4 sm:mb-8 text-xs sm:text-base max-w-md mx-auto">
        Looks like you haven't placed any orders yet. Start shopping to see your orders here.
      </p>

      <a href="#" class="inline-flex w-full sm:w-auto justify-center items-center px-4 sm:px-6 py-2 sm:py-3 border border-transparent text-xs sm:text-base font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 transition-colors">
        <i class='bx bx-shopping-bag mr-2'></i> Start Shopping
      </a>
    </div>
    {% endif %}
  </div>
</div>

<footer id="contact" class="bg-gray-900 text-gray-300 mt-8">
  <div class="container mx-auto px-3 sm:px-4 py-6 sm:py-12">
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-8 text-center sm:text-left">
      <div>
        <h3 class="text-base sm:text-xl font-bold text-white mb-2 sm:mb-4">Sona Enterprises</h3>
        <p class="text-xs sm:text-sm mb-3 sm:mb-4">Quality fashion, electronics, and toys for every occasion.</p>
        <div class="flex justify-center sm:justify-start space-x-3">
          <a href="#" class="text-gray-400 hover:text-white transition text-xs">Facebook</a>
          <a href="#" class="text-gray-400 hover:text-white transition text-xs">Instagram</a>
          <a href="#" class="text-gray-400 hover:text-white transition text-xs">Twitter</a>
        </div>
      </div>

      <div>
        <h3 class="text-base sm:text-xl font-bold text-white mb-2 sm:mb-4">Quick Links</h3>
        <ul class="space-y-1 text-xs sm:text-sm">
          <li><a href="#" class="hover:text-white transition">Home</a></li>
          <li><a href="#featured-products" class="hover:text-white transition">Shop</a></li>
          <li><a href="#" class="hover:text-white transition">About</a></li>
          <li><a href="#contact" class="hover:text-white transition">Contact</a></li>
        </ul>
      </div>

      <div>
        <h3 class="text-base sm:text-xl font-bold text-white mb-2 sm:mb-4">Support</h3>
        <ul class="space-y-1 text-xs sm:text-sm">
          <li><a href="#" class="hover:text-white transition">FAQ</a></li>
          <li><a href="#" class="hover:text-white transition">Shipping Info</a></li>
          <li><a href="#" class="hover:text-white transition">Returns</a></li>
          <li><a href="#" class="hover:text-white transition">Privacy</a></li>
        </ul>
      </div>

      <div>
        <h3 class="text-base sm:text-xl font-bold text-white mb-2 sm:mb-4">Contact</h3>
        <ul class="space-y-2 text-xs sm:text-sm">
          <li class="flex flex-col sm:flex-row sm:items-start gap-1 sm:gap-2">
            <span class="text-amber-400 flex-shrink-0">üìç</span>
            <span>123 Business Lane, City 12345</span>
          </li>
          <li class="flex justify-center sm:justify-start items-center gap-2">
            <span class="text-amber-400">üìû</span>
            <span>(123) 456-7890</span>
          </li>
          <li class="flex justify-center sm:justify-start items-center gap-2">
            <span class="text-amber-400">üìß</span>
            <span>hello@sonaenterprises.com</span>
          </li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-6 sm:mt-8 pt-4 sm:pt-8 text-center text-xs sm:text-sm">
      <p>&copy; <span id="current-year">2025</span> Sona Enterprises. All rights reserved.</p>
    </div>
  </div>
</footer>
