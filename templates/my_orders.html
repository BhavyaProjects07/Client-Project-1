{% include 'nav.html' %}

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

<script>
  tailwind.config = {
    theme: {
      extend: {
        colors: {
          primary: {
            50: '#f0fdf4',
            100: '#dcfce7',
            200: '#bbf7d0',
            300: '#86efac',
            400: '#4ade80',
            500: '#22c55e',
            600: '#16a34a',
            700: '#15803d',
            800: '#166534',
            900: '#14532d',
          }
        },
        fontFamily: {
          sans: ['Inter', 'sans-serif'],
        }
      }
    }
  }
</script>

<style>
  body {
    font-family: 'Inter', sans-serif;
  }

  .order-card {
    transition: all 0.3s ease;
  }

  .order-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
  }

  .product-image {
    transition: transform 0.3s ease;
  }

  .product-image:hover {
    transform: scale(1.05);
  }

  .status-delivered {
    background-color: #dcfce7;
    color: #166534;
  }

  .status-processing {
    background-color: #dbeafe;
    color: #1e40af;
  }

  .status-shipped {
    background-color: #fef3c7;
    color: #d97706;
  }

  .status-cancelled {
    background-color: #fee2e2;
    color: #dc2626;
  }

  .status-pending {
    background-color: #f3f4f6;
    color: #6b7280;
  }
</style>

<div class="bg-gray-50 min-h-screen">
  <div class="max-w-6xl mx-auto py-8 px-3 sm:px-4">
    <!-- Page Header -->
    <div class="text-center sm:text-left mb-6">
      <h1 class="text-2xl sm:text-3xl font-semibold text-gray-800">My Orders</h1>
      <p class="text-gray-500 text-sm sm:text-base">Track and manage your orders from any device.</p>
    </div>

    {% if orders %}
    <!-- Orders List -->
    <div class="space-y-4">
      {% for order in orders %}
      <div class="bg-white rounded-lg border border-gray-200 overflow-hidden order-card">
        <!-- Order Header -->
        <div class="bg-gray-50 px-4 sm:px-6 py-3 sm:py-4 border-b border-gray-200">
          <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-4">
            <div class="grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-4 text-xs sm:text-sm">
              <div>
                <p class="text-gray-500 uppercase text-[10px] sm:text-xs font-medium">Order Placed</p>
                <p class="font-medium text-gray-900">{{ order.created_at|date:"M d, Y" }}</p>
              </div>
              <div>
                <p class="text-gray-500 uppercase text-[10px] sm:text-xs font-medium">Total</p>
                <p class="font-bold text-gray-900">‚Çπ{{ order.total_amount }}</p>
              </div>
              <div>
                <p class="text-gray-500 uppercase text-[10px] sm:text-xs font-medium">Ship To</p>
                <p class="font-medium text-gray-900 truncate">{{ order.full_name|default:"Customer" }}</p>
              </div>
              <div>
                <p class="text-gray-500 uppercase text-[10px] sm:text-xs font-medium">Order #</p>
                <p class="font-medium text-primary-600">#{{ order.id }}</p>
              </div>
            </div>

            <div class="mt-3 sm:mt-0 flex items-center justify-center sm:justify-end">
              <span
                class="inline-flex items-center px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-medium status-{{ order.order_status|lower }}">
                <span class="w-2 h-2 rounded-full mr-2
                      {% if order.order_status == 'Delivered' %}bg-green-600
                      {% elif order.order_status == 'Processing' %}bg-blue-600
                      {% elif order.order_status == 'Shipped' %}bg-yellow-600
                      {% elif order.order_status == 'Cancelled' %}bg-red-600
                      {% else %}bg-gray-600{% endif %}"></span>
                {{ order.order_status }}
              </span>
            </div>
          </div>
        </div>

        <!-- Order Items -->
        <div class="p-4 sm:p-6">
          <div class="space-y-6">
            {% for item in order.items.all %}
            {% with product=item.get_product %}
            <div class="flex flex-col sm:flex-row sm:items-start space-y-4 sm:space-y-0 sm:space-x-6">
              <!-- Product Image -->
              <div class="flex-shrink-0 mx-auto sm:mx-0">
                <div class="relative">
                  <div
                    class="w-24 h-24 sm:w-32 sm:h-32 bg-gray-100 rounded-lg border border-gray-200 overflow-hidden mx-auto sm:mx-0">
                    <img src="{{ product.image.url }}" alt="{{ product.name }}"
                      class="w-full h-full object-contain product-image">
                  </div>
                  {% if item.quantity > 1 %}
                  <div
                    class="absolute -top-2 -right-2 bg-primary-500 text-white text-[10px] sm:text-xs font-bold rounded-full h-5 w-5 sm:h-6 sm:w-6 flex items-center justify-center">
                    {{ item.quantity }}
                  </div>
                  {% endif %}
                </div>
              </div>

              <!-- Product Details -->
              <div class="flex-1 min-w-0">
                <div class="flex flex-col sm:flex-row sm:justify-between">
                  <div class="flex-1 text-center sm:text-left">
                    <h3
                      class="text-base sm:text-lg font-medium text-gray-900 hover:text-primary-600 transition-colors cursor-pointer">
                      {{ product.name }}
                    </h3>

                    <div class="mt-1 flex justify-center sm:justify-start items-center text-xs sm:text-sm text-gray-500">
                      {% if product.category %}
                      <span>{{ product.category }}</span>
                      <span class="mx-2 hidden sm:inline">‚Ä¢</span>
                      {% endif %}
                      <span>Qty: {{ item.quantity }}</span>
                    </div>

                    <div class="mt-2 text-base sm:text-lg font-semibold text-gray-900">
                      ‚Çπ{{ product.price }}
                      {% if item.quantity > 1 %}
                      <span class="text-xs sm:text-sm font-normal text-gray-500">each</span>
                      {% endif %}
                    </div>

                    <!-- Delivery Status -->
                    <div class="mt-3 text-xs sm:text-sm">
                      {% if order.order_status == 'Delivered' %}
                      <div class="flex items-center justify-center sm:justify-start text-green-600">
                        <i class='bx bx-check-circle mr-1'></i>
                        <span class="font-medium">Delivered {{ order.updated_at|date:"M d" }}</span>
                      </div>
                      <p class="text-gray-500 mt-1">Your item was delivered</p>
                      {% elif order.order_status == 'Shipped' %}
                      <div class="flex items-center justify-center sm:justify-start text-blue-600">
                        <i class='bx bx-truck mr-1'></i>
                        <span class="font-medium">Out for delivery</span>
                      </div>
                      <p class="text-gray-500 mt-1">Your item is on the way</p>
                      {% elif order.order_status == 'Processing' %}
                      <div class="flex items-center justify-center sm:justify-start text-yellow-600">
                        <i class='bx bx-time mr-1'></i>
                        <span class="font-medium">Preparing for shipment</span>
                      </div>
                      <p class="text-gray-500 mt-1">We're getting your item ready</p>
                      {% else %}
                      <div class="flex items-center justify-center sm:justify-start text-gray-600">
                        <i class='bx bx-package mr-1'></i>
                        <span class="font-medium">Order confirmed</span>
                      </div>
                      <p class="text-gray-500 mt-1">We've received your order</p>
                      {% endif %}
                    </div>
                  </div>

                  <!-- Action Buttons -->
                  <div
                    class="mt-3 sm:mt-0 sm:ml-6 flex flex-col space-y-2 sm:items-end items-center text-center sm:text-right">
                    {% if order.order_status == 'Delivered' %}
                    <a href="{% url 'submit_review' order.id item.product_type product.id %}"
                      class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors">
                      <i class='bx bx-star mr-2'></i> Rate {{ product.name }}
                    </a>


                    {% endif %}
                  </div>
                </div>
              </div>
            </div>

            {% if not forloop.last %}
            <hr class="border-gray-200">
            {% endif %}
            {% endwith %}
            {% endfor %}
          </div>
        </div>

        <!-- Order Footer -->
        <div class="bg-gray-50 px-4 sm:px-6 py-3 sm:py-4 border-t border-gray-200">
          <div
            class="flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0 text-center sm:text-left">
            <div class="flex justify-center sm:justify-start items-center text-xs sm:text-sm text-gray-600">
              <i class='bx bx-info-circle mr-2'></i>
              <span>Need help with your order?</span>
            </div>

            <div class="flex flex-wrap justify-center sm:justify-end gap-2">
              

              {% if order.order_status != 'Delivered' and order.order_status != 'Cancelled' %}
              <a href="{% url 'track_order' order.id %}">
                <button
                  class="inline-flex items-center px-3 py-1.5 sm:py-2 bg-primary-600 border border-transparent rounded-md text-xs sm:text-sm font-medium text-white hover:bg-primary-700 transition-colors">
                  <i class='bx bx-map-pin mr-2'></i> Track Order
                </button>
              </a>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>

    <!-- Load More -->
    <div class="mt-6 sm:mt-8 text-center">
      <button
        class="inline-flex items-center px-5 py-2 sm:px-6 sm:py-3 border border-gray-300 rounded-md text-xs sm:text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors">
        <i class='bx bx-refresh mr-2'></i> Load More Orders
      </button>
    </div>

    {% else %}
    <!-- Empty State -->
    <div class="bg-white rounded-lg border border-gray-200 p-8 sm:p-12 text-center">
      <div class="mx-auto w-20 h-20 sm:w-24 sm:h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6">
        <i class='bx bx-package text-3xl sm:text-4xl text-gray-400'></i>
      </div>

      <h3 class="text-lg sm:text-xl font-semibold text-gray-900 mb-2">No orders yet</h3>
      <p class="text-gray-600 mb-6 sm:mb-8 text-sm sm:text-base max-w-md mx-auto">
        Looks like you haven't placed any orders yet. Start shopping to see your orders here.
      </p>

      <a href="#"
        class="inline-flex items-center px-5 sm:px-6 py-2 sm:py-3 border border-transparent text-sm sm:text-base font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 transition-colors">
        <i class='bx bx-shopping-bag mr-2'></i> Start Shopping
      </a>
    </div>
    {% endif %}
  </div>
</div>

<footer id="contact" class="bg-gray-900 text-gray-300">
  <div class="container mx-auto px-3 sm:px-4 py-8 sm:py-12">
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 sm:gap-8 text-center sm:text-left">
      <!-- Brand -->
      <div>
        <h3 class="text-lg sm:text-xl font-bold text-white mb-3 sm:mb-4">Sona Enterprises</h3>
        <p class="text-xs sm:text-sm mb-4">Quality fashion, electronics, and toys for every occasion.</p>
        <div class="flex justify-center sm:justify-start space-x-3">
          <a href="#" class="text-gray-400 hover:text-white transition text-sm">Facebook</a>
          <a href="#" class="text-gray-400 hover:text-white transition text-sm">Instagram</a>
          <a href="#" class="text-gray-400 hover:text-white transition text-sm">Twitter</a>
        </div>
      </div>

      <!-- Quick Links -->
      <div>
        <h3 class="text-lg sm:text-xl font-bold text-white mb-3 sm:mb-4">Quick Links</h3>
        <ul class="space-y-1 sm:space-y-2 text-xs sm:text-sm">
          <li><a href="#" class="hover:text-white transition">Home</a></li>
          <li><a href="#featured-products" class="hover:text-white transition">Shop</a></li>
          <li><a href="#" class="hover:text-white transition">About</a></li>
          <li><a href="#contact" class="hover:text-white transition">Contact</a></li>
        </ul>
      </div>

      <!-- Support -->
      <div>
        <h3 class="text-lg sm:text-xl font-bold text-white mb-3 sm:mb-4">Support</h3>
        <ul class="space-y-1 sm:space-y-2 text-xs sm:text-sm">
          <li><a href="#" class="hover:text-white transition">FAQ</a></li>
          <li><a href="#" class="hover:text-white transition">Shipping Info</a></li>
          <li><a href="#" class="hover:text-white transition">Returns</a></li>
          <li><a href="#" class="hover:text-white transition">Privacy</a></li>
        </ul>
      </div>

      <!-- Contact -->
      <div>
        <h3 class="text-lg sm:text-xl font-bold text-white mb-3 sm:mb-4">Contact</h3>
        <ul class="space-y-2 text-xs sm:text-sm">
          <li class="flex flex-col sm:flex-row sm:items-start gap-1 sm:gap-2">
            <span class="text-amber-400">üìç</span>
            <span>123 Business Lane, City 12345</span>
          </li>
          <li class="flex justify-center sm:justify-start items-center gap-2">
            <span class="text-amber-400">üìû</span>
            <span>(123) 456-7890</span>
          </li>
          <li class="flex justify-center sm:justify-start items-center gap-2">
            <span class="text-amber-400">üìß</span>
            <span>hello@sonaenterprises.com</span>
          </li>
        </ul>
      </div>
    </div>

    <div class="border-t border-gray-800 mt-8 pt-6 sm:pt-8 text-center text-xs sm:text-sm">
      <p>&copy; <span id="current-year">2025</span> Sona Enterprises. All rights reserved.</p>
    </div>
  </div>
</footer>
